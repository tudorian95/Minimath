# MathOps Microservice

Python microservice that supports three math operations: power, fibonacci, and factorial.

## Tech stack
- Python 3.11 lite
  - FastAPI async API
  - Async worker queue
  - SQLite logging
  - Pydantic for serialization
- Docker-ready
- Minikube-compliant

## Build and deploy on Windows
Prerequisites: 
- docker up and running
- minikube installed
- git installed (optional)

Select a folder in which you want to download the repository, 'cd' to said folder path and then run these commands in a new Powershell session:

### Git 
```cmd
git clone https://github.com/tudorian95/Minimath.git
```
```cmd
cd .\Minimath
```
### Docker
```cmd
docker build -t mathcontainer .
```
 (^ 'mathcontainer' being the image name already preconfigured in the deployment file for minikube)

### Minikube
```cmd
minikube start
```
```cmd
minikube image load mathcontainer:latest
```
```cmd
kubectl apply -f ./math-deployment.yaml
```
```cmd
kubectl apply -f ./math-config.yaml
```
```cmd
kubectl get pods
```
(^ should show 2 pods with running status)
```cmd
minikube service math-calculator-service --url
```
(^ will return a http link at which the app is hosted)

## Build and deploy on Linux distros
Prerequisites: 
- same as for Windows

```cmd
git clone https://github.com/tudorian95/Minimath.git
```
```cmd
cd ./Minimath
```
```cmd
docker build -t mathcontainer .
```
```cmd
minikube start --driver=docker
```
```cmd
minikube image load mathcontainer:latest
```
```cmd
kubectl apply -f math-deployment.yaml
```
```cmd
kubectl apply -f math-config.yaml
```
```cmd
kubectl get pods
```
```cmd
minikube service math-calculator-service --url
```

## Interact with the web UI
Double click on or copy paste the url generated by the 'minikube service --url' command and append '/ui' at the end of it in order to interact with the application.

Another endpoint is '/db' for a history of the operations being made.

You can also use '/docs' to inspect all endpoints.
